<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.5 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Finagled with IMDB datasets to Organize Data for Analysis of U.S. Movie Quality Over the Last 3 Decades - Chris Chung</title>
<meta name="description" content="I was rewatching some of my favorite movies from the 90s and early 2000s like Austin Powers…">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Chris Chung">
<meta property="og:title" content="Finagled with IMDB datasets to Organize Data for Analysis of U.S. Movie Quality Over the Last 3 Decades">
<meta property="og:url" content="http://localhost:4000/organize%20data/tidy%20data/data-imdb/">


  <meta property="og:description" content="I was rewatching some of my favorite movies from the 90s and early 2000s like Austin Powers…">



  <meta property="og:image" content="http://localhost:4000/images/data-imdb/cinema-room-header.jpg">





  <meta property="article:published_time" content="2019-08-23T00:00:00-04:00">





  

  


<link rel="canonical" href="http://localhost:4000/organize%20data/tidy%20data/data-imdb/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Chris Chung",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>



  <meta name="google-site-verification" content="eTEQHHs6V5HyxKsaNQsx3NZ6pw6ULe6bYc0B2x4-RrU" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Chris Chung Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Chris Chung
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/" >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  











<div class="page__hero"
  style=" "
>
  
    <img src="/images/data-imdb/cinema-room-header.jpg" alt="Finagled with IMDB datasets to Organize Data for Analysis of U.S. Movie Quality Over the Last 3 Decades" class="page__hero-image">
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/images/bio-pic.png" alt="Chris Chung" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Chris Chung</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Data Science Project Portfolio</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Contact Info</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">New York, NY</span>
        </li>
      

      
        
          
            <li><a href="mailto:chrispfchung@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> chrispfchung@gmail.com</a></li>
          
        
          
            <li><a href="https://chrispfchung.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Portfolio</a></li>
          
        
          
        
          
        
          
            <li><a href="https://github.com/chrispfchung" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/chrischung28/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
          
        
          
            <li><a href="https://instagram.com/chrispfchung" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Finagled with IMDB datasets to Organize Data for Analysis of U.S. Movie Quality Over the Last 3 Decades">
    <meta itemprop="description" content="I was rewatching some of my favorite movies from the 90s and early 2000s like Austin Powers…">
    <meta itemprop="datePublished" content="August 23, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Finagled with IMDB datasets to Organize Data for Analysis of U.S. Movie Quality Over the Last 3 Decades
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fas fa-book-open"></i> Table of Contents</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#project-description" id="markdown-toc-project-description">Project Description</a></li>
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#import-libraries-and-datasets" id="markdown-toc-import-libraries-and-datasets">Import Libraries and Datasets</a></li>
  <li><a href="#filter-us-movies" id="markdown-toc-filter-us-movies">Filter U.S Movies</a></li>
  <li><a href="#convert-year-made-and-movie-runtime-to-integers" id="markdown-toc-convert-year-made-and-movie-runtime-to-integers">Convert Year Made and Movie Runtime to Integers</a></li>
  <li><a href="#remove-duplicates" id="markdown-toc-remove-duplicates">Remove Duplicates</a></li>
  <li><a href="#final-output" id="markdown-toc-final-output">Final Output</a>    <ul>
      <li><a href="#final-features" id="markdown-toc-final-features">Final Features</a></li>
    </ul>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
  <li><a href="#next-steps" id="markdown-toc-next-steps">Next Steps</a>    <ul>
      <li><a href="#resources-consulted" id="markdown-toc-resources-consulted">Resources Consulted</a></li>
    </ul>
  </li>
</ul>

  </nav>
</aside>
<p><br /></p>

<h2 id="project-description">Project Description</h2>
<p>Combined three datasets from IMDB and filtered necessary data to answer the question, “Has the quality of movies declined in the last 30 years?” In this project, I drop and alter columns to get only data from U.S movies since 1990-2019. After cleaning the data, I will use this data in the next project for movie comparison with an emphasis on Comedy and Drama movies.</p>

<h2 id="introduction">Introduction</h2>

<p>I was rewatching some of my favorite movies from the 90s and early 2000s like Austin Powers, Scary Movie, and Shawshank Redemption, and wondered why I don’t enjoy movies that are made today. I wondered if the movie quality has declined since that time. In this project, “Finagled with IMDB datasets to Organize Data for Analysis of U.S. Movie Quality From 1990-2019”, I will import the IMDB datasets containing different data like ratings, movie names and language (we’ll primarily work with English movies). Then I organize the data in pandas to finally merge a final dataset that I can use to analyze in the next project.</p>

<h2 id="import-libraries-and-datasets">Import Libraries and Datasets</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="nb">FutureWarning</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># default='warn'
</span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># source dataset : https://www.imdb.com/interfaces/
</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s">'title.ratings.tsv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>

<span class="n">allmovies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s">'title.basics.tsv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>

<span class="n">languagemovies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s">'title.akas.tsv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<p>Originally we have millions of movie data points. But after filtering and narrowing down the data to exactly what we want, we won’t have this much data but we’ll have very specific information that will be useful for the next project.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">allmovies</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># 5,974,826 movies and 8 Features
</span><span class="k">print</span><span class="p">(</span><span class="n">languagemovies</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># 3,683,865 movies and 7 Features
</span><span class="k">print</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># 947,891 movies and 2 Features
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(5974826, 8)
(3683865, 7)
(947891, 2)
</code></pre></div></div>

<h2 id="filter-us-movies">Filter U.S Movies</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#filter movies all in USA, I'm assuming it means the main language is English
</span><span class="n">englishmovies</span> <span class="o">=</span> <span class="n">languagemovies</span><span class="p">[</span><span class="n">languagemovies</span><span class="p">[</span><span class="s">'region'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'US'</span><span class="p">]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'titleId'</span><span class="p">,</span> <span class="s">'title'</span><span class="p">,</span> <span class="s">'region'</span><span class="p">]</span>
<span class="n">englishmovies</span><span class="p">[</span><span class="s">'titleId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">englishmovies</span><span class="o">.</span><span class="n">index</span>
<span class="n">englishmovies</span> <span class="o">=</span> <span class="n">englishmovies</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<span class="n">englishmovies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>       
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>titleId</th>
      <th>title</th>
      <th>region</th>
    </tr>
    <tr>
      <th>titleId</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>tt0000001</th>
      <td>tt0000001</td>
      <td>Carmencita</td>
      <td>US</td>
    </tr>
    <tr>
      <th>tt0000002</th>
      <td>tt0000002</td>
      <td>The Clown and His Dogs</td>
      <td>US</td>
    </tr>
    <tr>
      <th>tt0000005</th>
      <td>tt0000005</td>
      <td>Blacksmithing Scene</td>
      <td>US</td>
    </tr>
    <tr>
      <th>tt0000005</th>
      <td>tt0000005</td>
      <td>Blacksmith Scene #1</td>
      <td>US</td>
    </tr>
    <tr>
      <th>tt0000005</th>
      <td>tt0000005</td>
      <td>Blacksmithing</td>
      <td>US</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create titleId column to join tables later on
</span><span class="n">allmovies</span><span class="p">[</span><span class="s">'titleId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">allmovies</span><span class="o">.</span><span class="n">index</span>
<span class="c1">#get a titleId to prep for a merge on titleId
</span><span class="n">ratings</span><span class="p">[</span><span class="s">'titleId'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">index</span>

<span class="c1">#movies only
</span><span class="n">allmovies</span> <span class="o">=</span> <span class="n">allmovies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">allmovies</span><span class="p">[</span><span class="s">'titleType'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'movie'</span><span class="p">]</span>
<span class="n">allmovies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>titleType</th>
      <th>primaryTitle</th>
      <th>originalTitle</th>
      <th>isAdult</th>
      <th>startYear</th>
      <th>endYear</th>
      <th>runtimeMinutes</th>
      <th>genres</th>
      <th>titleId</th>
    </tr>
    <tr>
      <th>tconst</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>tt0000009</th>
      <td>movie</td>
      <td>Miss Jerry</td>
      <td>Miss Jerry</td>
      <td>0</td>
      <td>1894</td>
      <td>\N</td>
      <td>45</td>
      <td>Romance</td>
      <td>tt0000009</td>
    </tr>
    <tr>
      <th>tt0000147</th>
      <td>movie</td>
      <td>The Corbett-Fitzsimmons Fight</td>
      <td>The Corbett-Fitzsimmons Fight</td>
      <td>0</td>
      <td>1897</td>
      <td>\N</td>
      <td>20</td>
      <td>Documentary,News,Sport</td>
      <td>tt0000147</td>
    </tr>
    <tr>
      <th>tt0000335</th>
      <td>movie</td>
      <td>Soldiers of the Cross</td>
      <td>Soldiers of the Cross</td>
      <td>0</td>
      <td>1900</td>
      <td>\N</td>
      <td>\N</td>
      <td>Biography,Drama</td>
      <td>tt0000335</td>
    </tr>
    <tr>
      <th>tt0000502</th>
      <td>movie</td>
      <td>Bohemios</td>
      <td>Bohemios</td>
      <td>0</td>
      <td>1905</td>
      <td>\N</td>
      <td>100</td>
      <td>\N</td>
      <td>tt0000502</td>
    </tr>
    <tr>
      <th>tt0000574</th>
      <td>movie</td>
      <td>The Story of the Kelly Gang</td>
      <td>The Story of the Kelly Gang</td>
      <td>0</td>
      <td>1906</td>
      <td>\N</td>
      <td>70</td>
      <td>Biography,Crime,Drama</td>
      <td>tt0000574</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#combine ALL matching on titleId, forget everything else.
</span><span class="n">results</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">englishmovies</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'inner'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'titleId'</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">allmovies</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'inner'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'titleId'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># narrowing down to 111,889 and 13 features
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(111889, 13)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#remove columns i'm not using and create new table
</span>
<span class="c1">#columns I want
</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'primaryTitle'</span><span class="p">,</span> <span class="s">'startYear'</span><span class="p">,</span> <span class="s">'genres'</span><span class="p">,</span> <span class="s">'averageRating'</span><span class="p">,</span> <span class="s">'numVotes'</span><span class="p">,</span> <span class="s">'runtimeMinutes'</span><span class="p">,</span> <span class="s">'titleType'</span><span class="p">,</span> <span class="s">'region'</span><span class="p">,</span> <span class="s">'titleId'</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primaryTitle</th>
      <th>startYear</th>
      <th>genres</th>
      <th>averageRating</th>
      <th>numVotes</th>
      <th>runtimeMinutes</th>
      <th>titleType</th>
      <th>region</th>
      <th>titleId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Miss Jerry</td>
      <td>1894</td>
      <td>Romance</td>
      <td>5.5</td>
      <td>80</td>
      <td>45</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0000009</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Corbett-Fitzsimmons Fight</td>
      <td>1897</td>
      <td>Documentary,News,Sport</td>
      <td>5.2</td>
      <td>300</td>
      <td>20</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0000147</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hamlet</td>
      <td>1908</td>
      <td>Drama</td>
      <td>2.9</td>
      <td>11</td>
      <td>\N</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0000630</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Fairylogue and Radio-Plays</td>
      <td>1908</td>
      <td>Adventure,Fantasy</td>
      <td>4.8</td>
      <td>33</td>
      <td>120</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0000679</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hamlet, Prince of Denmark</td>
      <td>1910</td>
      <td>Drama</td>
      <td>5.1</td>
      <td>19</td>
      <td>\N</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0000886</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="convert-year-made-and-movie-runtime-to-integers">Convert Year Made and Movie Runtime to Integers</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#turn start year and runtime Minutes into integer and remove NA
</span><span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s">'startYear'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'</span><span class="se">\\</span><span class="s">N'</span><span class="p">]</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s">'runtimeMinutes'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'</span><span class="se">\\</span><span class="s">N'</span><span class="p">]</span>

<span class="c1">#turn start year and runtime Minutes into integers from strings
</span><span class="n">results</span><span class="p">[</span><span class="s">'startYear'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s">'startYear'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s">'runtimeMinutes'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s">'runtimeMinutes'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span>

<span class="c1">#Keeping only movies that started from 1990 up to 2019
</span><span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">results</span><span class="p">[</span><span class="s">'startYear'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1990</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s">'startYear'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2019</span><span class="p">)]</span>

<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primaryTitle</th>
      <th>startYear</th>
      <th>genres</th>
      <th>averageRating</th>
      <th>numVotes</th>
      <th>runtimeMinutes</th>
      <th>titleType</th>
      <th>region</th>
      <th>titleId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12797</th>
      <td>Kate &amp; Leopold</td>
      <td>2001</td>
      <td>Comedy,Fantasy,Romance</td>
      <td>6.4</td>
      <td>74330</td>
      <td>118</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0035423</td>
    </tr>
    <tr>
      <th>12798</th>
      <td>Kate &amp; Leopold</td>
      <td>2001</td>
      <td>Comedy,Fantasy,Romance</td>
      <td>6.4</td>
      <td>74330</td>
      <td>118</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0035423</td>
    </tr>
    <tr>
      <th>26357</th>
      <td>Wenn du groß bist, lieber Adam</td>
      <td>1990</td>
      <td>Drama,Fantasy</td>
      <td>6.9</td>
      <td>23</td>
      <td>78</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0059900</td>
    </tr>
    <tr>
      <th>30878</th>
      <td>The Other Side of the Wind</td>
      <td>2018</td>
      <td>Drama</td>
      <td>6.9</td>
      <td>4589</td>
      <td>122</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0069049</td>
    </tr>
    <tr>
      <th>36244</th>
      <td>Me and the Kid</td>
      <td>1993</td>
      <td>Comedy,Crime,Drama</td>
      <td>5.3</td>
      <td>211</td>
      <td>94</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0081145</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="remove-duplicates">Remove Duplicates</h2>

<p>Let’s remove duplicates with same titleId because same title doesn’t necessarily mean same movie.
There are a lot of movies that are listed as different names.
There’s something called ‘working title’ which means it was a tentative title used during development.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s">'titleId'</span><span class="p">]</span> <span class="o">==</span> <span class="n">results</span><span class="p">[</span><span class="s">'titleId'</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1">#Drop duplicate under titleId
</span><span class="n">results</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s">'first'</span><span class="p">,</span><span class="n">subset</span><span class="o">=</span><span class="s">'titleId'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="final-output">Final Output</h2>

<h3 id="final-features">Final Features</h3>

<ol>
  <li><em>‘primaryTitle’</em>, - <strong>Title of the movie</strong></li>
  <li><em>‘startYear’</em>, - <strong>Year the Movie was Made</strong></li>
  <li><em>‘genres</em>’, - <strong>Genre of the Movie</strong></li>
  <li><em>‘averageRating’</em>, - <strong>Average Rating of the Movie</strong></li>
  <li><em>‘numVotes’</em>, - <strong>Number of IMDB votes for the Movie</strong></li>
  <li><em>‘runtimeMinutes’</em>, - <strong>Length of the Movie in Minutes</strong></li>
  <li><em>‘titleType’</em>, - <strong>Movies Only</strong></li>
  <li><em>‘region’</em>,  - <strong>U.S. Only</strong></li>
  <li><em>‘titleId’</em> - <strong>Unique ID number of the Movie</strong></li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># 45,924 movies and 9 Features
</span><span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># Final dataset
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(45924, 9)
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primaryTitle</th>
      <th>startYear</th>
      <th>genres</th>
      <th>averageRating</th>
      <th>numVotes</th>
      <th>runtimeMinutes</th>
      <th>titleType</th>
      <th>region</th>
      <th>titleId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12797</th>
      <td>Kate &amp; Leopold</td>
      <td>2001</td>
      <td>Comedy,Fantasy,Romance</td>
      <td>6.4</td>
      <td>74330</td>
      <td>118</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0035423</td>
    </tr>
    <tr>
      <th>26357</th>
      <td>Wenn du groß bist, lieber Adam</td>
      <td>1990</td>
      <td>Drama,Fantasy</td>
      <td>6.9</td>
      <td>23</td>
      <td>78</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0059900</td>
    </tr>
    <tr>
      <th>30878</th>
      <td>The Other Side of the Wind</td>
      <td>2018</td>
      <td>Drama</td>
      <td>6.9</td>
      <td>4589</td>
      <td>122</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0069049</td>
    </tr>
    <tr>
      <th>36244</th>
      <td>Me and the Kid</td>
      <td>1993</td>
      <td>Comedy,Crime,Drama</td>
      <td>5.3</td>
      <td>211</td>
      <td>94</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0081145</td>
    </tr>
    <tr>
      <th>36467</th>
      <td>Vincent and Me</td>
      <td>1990</td>
      <td>Drama,Family,Fantasy</td>
      <td>6.5</td>
      <td>278</td>
      <td>100</td>
      <td>movie</td>
      <td>US</td>
      <td>tt0081721</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#save our dataframe to a pickle for use in other notebooks
</span><span class="n">results</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s">'results.pkl'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>
<p>In this project, we examined three large movie datasets from IMDB and combined specific columns for further analysis. We dropped columns, merged tables, changed datatypes and finally saved the table of 9 rows into pickle format for analysis in the next part of the project.</p>

<h2 id="next-steps">Next Steps</h2>

<p>I will use this dataset and visualize the U.S. movie trends. I want to see above all how the ratings of Comedy movies around 1995-2005 compared to other Comedy movies later on. I’m excited to see what I’ll find out!</p>

<h4 id="resources-consulted">Resources Consulted</h4>
<ol>
  <li>How to load a tsv file into pandas <a href="https://stackoverflow.com/questions/9652832/how-to-load-a-tsv-file-into-a-pandas-dataframe">https://stackoverflow.com/questions/9652832/how-to-load-a-tsv-file-into-a-pandas-dataframe</a></li>
  <li>How to retrieve column values between two halfways</li>
</ol>
<p><a href="https://stackoverflow.com/questions/31617845/how-to-select-rows-in-a-dataframe-between-two-values-in-python-pandas/40442778">https://stackoverflow.com/questions/31617845/how-to-select-rows-in-a-dataframe-between-two-values-in-python-pandas/40442778</a></p>
<ol>
  <li>How to deal with red warning signs in pandas</li>
</ol>
<p><a href="https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas">https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas</a></p>
<ol>
  <li>Efficient ways to drop nan rows in pandas</li>
</ol>
<p><a href="https://stackoverflow.com/questions/36370839/better-way-to-drop-nan-rows-in-pandas">https://stackoverflow.com/questions/36370839/better-way-to-drop-nan-rows-in-pandas</a></p>
<ol>
  <li>How to get unique values from column</li>
</ol>
<p><a href="https://cmdlinetips.com/2018/01/how-to-get-unique-values-from-a-column-in-pandas-data-frame/">https://cmdlinetips.com/2018/01/how-to-get-unique-values-from-a-column-in-pandas-data-frame/</a></p>
<ol>
  <li>How to suppress additional future warnings</li>
</ol>
<p><a href="https://stackoverflow.com/questions/15777951/how-to-suppress-pandas-future-warning/15778297">https://stackoverflow.com/questions/15777951/how-to-suppress-pandas-future-warning/15778297</a></p>
<ol>
  <li>What are the datatypes to remember in pandas dataframe?</li>
</ol>
<p><a href="https://pbpython.com/pandas_dtypes.html">https://pbpython.com/pandas_dtypes.html</a></p>
<ol>
  <li>What happened with series?</li>
</ol>
<p><a href="https://www.ritchieng.com/pandas-exploring-series/">https://www.ritchieng.com/pandas-exploring-series/</a></p>
<ol>
  <li>What is the truth value ambiguous error?</li>
</ol>
<p><a href="https://stackoverflow.com/questions/36921951/truth-value-of-a-series-is-ambiguous-use-a-empty-a-bool-a-item-a-any-o">https://stackoverflow.com/questions/36921951/truth-value-of-a-series-is-ambiguous-use-a-empty-a-bool-a-item-a-any-o</a></p>
<ol>
  <li>How do you show duplicated dataframe?</li>
</ol>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.duplicated.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.duplicated.html</a></p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#organize-data" class="page__taxonomy-item" rel="tag">Organize Data</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#tidy-data" class="page__taxonomy-item" rel="tag">Tidy Data</a>
    
    </span>
  </p>






  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Data Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/datatags/#labeled-data" class="page__taxonomy-item" rel="tag">labeled data</a><span class="sep">, </span>
    
      
      
      <a href="/datatags/#movie-data" class="page__taxonomy-item" rel="tag">movie data</a>
    
    </span>
  </p>





  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Technology Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/technologytags/#pandas" class="page__taxonomy-item" rel="tag">pandas</a><span class="sep">, </span>
    
      
      
      <a href="/technologytags/#python" class="page__taxonomy-item" rel="tag">python</a>
    
    </span>
  </p>






        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-08-23T00:00:00-04:00">August 23, 2019</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Finagled+with+IMDB+datasets+to+Organize+Data+for+Analysis+of+U.S.+Movie+Quality+Over+the+Last+3+Decades%20http%3A%2F%2Flocalhost%3A4000%2Forganize%2520data%2Ftidy%2520data%2Fdata-imdb%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Forganize%2520data%2Ftidy%2520data%2Fdata-imdb%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Forganize%2520data%2Ftidy%2520data%2Fdata-imdb%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/tidy%20data/seatgeek-data-cleaning/" class="pagination--pager" title="Dove into SeatGeek New York Concert Dataset to Clean Data for Future Visualization and Analysis
">Previous</a>
    
    
      <a href="/model%20data/boston-housing-data/" class="pagination--pager" title="Used Linear Regression to Model and Predict Housing Prices with the Classic Boston Housing Dataset
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/visualize%20data/spotify-top-200/" rel="permalink">Visualized Spotify Global’s Top 200 Summer Songs 2019 with Tableau
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Global Top 200 Songs…
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/model%20data/boston-housing-data/" rel="permalink">Used Linear Regression to Model and Predict Housing Prices with the Classic Boston Housing Dataset
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  11 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Linear Regression is one of the fundamental machine learning techniques in data science. It makes predictions…
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/tidy%20data/seatgeek-data-cleaning/" rel="permalink">Dove into SeatGeek New York Concert Dataset to Clean Data for Future Visualization and Analysis
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  9 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">It’s a cliché that data cleaning takes 85% …
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/store%20data/extract%20data/nasa-select-data/" rel="permalink">Created a Database of Planet Information to Store Data so That Our Imaginary NASA Has Data to Query
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  13 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">SQLite3 is a database where I can perform SQL commands to extract…
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Contact Info:</strong></li>
    

    
      
        
          <li><a href="mailto:chrispfchung@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email Me</a></li>
        
      
        
          <li><a href="https://chrispfchung.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Portfolio</a></li>
        
      
        
      
        
      
        
          <li><a href="https://github.com/chrispfchung" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
          <li><a href="https://www.linkedin.com/in/chrischung28/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://instagram.com/chrispfchung" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Chris Chung. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



  </body>
</html>
